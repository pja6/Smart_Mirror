---
---

<script>
// Get API key from server side .ENV file --- thanks to vite
const APIKEY = import.meta.env.PUBLIC_WEATHER_API;

// API endpoint URL
const queryEndpoint = 'https://api.openweathermap.org/data/2.5/weather';
// City
const queryCity = 'Spokane';
// Units for Farenheit
const queryUnits = 'imperial';

// URL query string
const url = `${queryEndpoint}?q=${queryCity}&appid=${APIKEY}&units=${queryUnits}`;

// Get DOM Elements
const city = document.querySelector('h1');
const temp = document.getElementById('temp');
const icon = document.querySelector('img');

const weatherDesc=document.getElementById("desc");
const windSpeed=document.getElementById("wind");
const feelsLike=document.getElementById("feels");
const weatherDetailsContainer = document.getElementById('weather-details-container');

// Using fetch to get data
fetch(url)
.then( response => response.json() )
.then( weatherData => {

  // Check-check: Is data good? 
  console.log( weatherData );
  city.textContent = weatherData.name;
  weatherDesc.textContent=weatherData.weather[0].description;
  temp.textContent = weatherData.main.temp+"°F"; ;
  windSpeed.textContent="Wind Speed: "+weatherData.wind.speed+" mph";

  const feelsLikeValue = weatherData.main.feels_like;
  const feelsLikeLabel = document.createElement('p');
    const feelsLikeText = document.createTextNode('Feels like: ');
    const feelsLikeValueElement = document.createElement('span');
    feelsLikeValueElement.textContent = `${feelsLikeValue}°F`;
    feelsLikeValueElement.classList.add("stat-figure", "text-blue-300"); 

    feelsLikeLabel.appendChild(feelsLikeText);
    feelsLikeLabel.appendChild(feelsLikeValueElement);
    weatherDetailsContainer.appendChild(feelsLikeLabel);
    
    icon.setAttribute("src", `https://openweathermap.org/img/wn/${weatherData.weather[0].icon}.png`);
  const rain = weatherData.rain ? weatherData.rain['1h'] : 0; // Assuming rain is in mm for the last 1 hour
    const humidity = weatherData.main.humidity;
    const rainInfo = document.createElement('p');
    rainInfo.innerHTML = `Rain: <data value="${rain}" class="p">${rain} mm</data>`;

    const humidityInfo = document.createElement('p');
    humidityInfo.innerHTML = `Humidity: <data value="${humidity}" class="p">${humidity}%</data>`;

    // Append the new paragraphs to the document (assumed to be part of an existing container)
    weatherDetailsContainer.appendChild(rainInfo);
    weatherDetailsContainer.appendChild(humidityInfo);
  
});

navigator.geolocation.getCurrentPosition(function(position){
    const lat=position.coords.latitude;
    const long=position.coords.longitude;
  console.log(lat, long);
})
</script>


<!-- Weather -->
 <div class=" card glass">
<section class="weather card-body flex">
  <div class="weather flex flex-col">
    <h1 class="font-bold text-4xl text-gray-50 drop-shadow text-center">City</h1>
    <div class="pt-6 flex justify-center items-center">
    <img class="ring-blue-500 ring-offset-base-100 w-32 rounded-full ring ring-offset-2" src="" alt="weather">
    </div>
    <h3 class="p-3 italic font-semibold text-center" id="desc">desc</h3>
    <h3 id="temp" class="stat-figure text-blue-300 text-xl text-bold">Temp</h3>
    <h3 class="p-3" id="wind">wind</h3>
    <h3 class="stat-figure text-blue-300" id="feels"></h3>
    <div id="weather-details-container"></div>

      </div>
    
</section>
</div>